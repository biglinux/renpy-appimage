# Maintainer: Barnab√© di Kartola <barnabedikartola@gmail.com>

_pkgname=renpy
pkgname=${_pkgname}-appimage
pkgver=8.1.3
pkgrel=0
pkgdesc="Visual novel engine Ren'Py along with its platdeps libs"
arch=('any')
license=('MIT')
provides=('renpy')
conflicts=('renpy' 'renpy-git')
# depends=('')
makedepends=('appimagetool' 'desktop-file-utils')
_filename="${_pkgname}-${pkgver}.appimage"
url="https://github.com/biglinux/$pkgname"
source=("git+${url}.git")
md5sums=('SKIP')
if [ -e "${pkgname}.install" ];then
    install=${pkgname}.install
elif [ -e "pkgbuild.install" ];then
    install=pkgbuild.install
fi

prepare() {
  cd ${srcdir}
  unset SOURCE_DATE_EPOCH
  ARCH=$(uname -m) appimagetool ${srcdir}/${pkgname}/${_pkgname}.AppDir $_filename
}

package() {
  cp -r "${srcdir}/${pkgname}/usr" "${pkgdir}/"
  mkdir -p ${pkgdir}/opt/appimages/
  mv ${srcdir}/${_filename} ${pkgdir}/opt/appimages/
}
